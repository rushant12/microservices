public RestTemplate createRestTemplateWithProxy() {
    String proxyHost = "webproxy.africa.nedcor.net";
    int proxyPort = 9001;
    String proxyUser = "CC437236";
    String proxyPass = "34dYaB@jEh56";

    HttpHost proxy = new HttpHost(proxyHost, proxyPort);

    BasicCredentialsProvider credsProvider = new BasicCredentialsProvider();
    credsProvider.setCredentials(
            new AuthScope(proxyHost, proxyPort),
            new UsernamePasswordCredentials(proxyUser, proxyPass)
    );

    DefaultProxyRoutePlanner routePlanner = new DefaultProxyRoutePlanner(proxy);

    org.apache.http.client.HttpClient httpClient = HttpClients.custom()
            .setDefaultCredentialsProvider(credsProvider)
            .setRoutePlanner(routePlanner)
            .build();

    HttpComponentsClientHttpRequestFactory factory = new HttpComponentsClientHttpRequestFactory(httpClient);
    return new RestTemplate(factory);
}
